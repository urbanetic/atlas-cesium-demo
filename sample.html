<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>atlas-cesium demo</title>
  <script type="text/javascript">
    less = {
      relativeUrls: true
    };
  </script>
  <link rel="stylesheet/less" href="atlas/resources/atlas.less">
  <link rel="stylesheet/less" href="atlas-cesium/resources/atlas-cesium.less">
  <style>
    html, body, #cesium {
      margin: 0;
      height: 100%;
    }
  </style>
  <script src="atlas/lib/less/dist/less-1.7.0.min.js"></script>
  <script src="atlas-cesium/lib/Requirejs/require.js"></script>
  <script>
    var cesiumAtlas;

    console.debug('Requiring CesiumAtlas');

    require.config({
      baseUrl: '',
      packages: [
        { name: 'atlas', location: 'atlas/src'},
        { name: 'atlas/lib', location: 'atlas/lib'},
        { name: 'atlas/lib/utility', location: 'atlas/lib/utility/src'},
        { name: 'atlas/assets', location: 'atlas/assets'}, // Only need this for testing
        { name: 'atlas-cesium', location: 'atlas-cesium/src'},
        { name: 'atlas-cesium/lib', location: 'atlas-cesium/lib'},
        { name: 'atlas-cesium/cesium', location: 'atlas-cesium/lib/cesium'},
        { name: 'atlas-cesium/lib', location: 'atlas-cesium/lib'},
        { name: 'jquery', location: 'lib/jquery/dist', main: 'jquery.min'}
      ]
    });

    require([
      'atlas-cesium/core/CesiumAtlas',
      'atlas/assets/testWKT',
      'atlas/material/Color',
      'atlas/material/Style',
      'atlas/lib/utility/Setter'
    ], function(CesiumAtlas, testWKT, Color, Style, Setter) {
      console.debug('Creating atlas-cesium');
      cesiumAtlas = new CesiumAtlas();
      cesiumAtlas.attachTo('cesium');

      cesiumAtlas.publish('debugMode', true);
      window.atlas = cesiumAtlas;

      var i = 0;
      var args = {};
      args.show = true;
      args.displayMode = 'extrusion';

      testWKT.forEach(function(wkt) {
        var id = args.id = i++;
        args.polygon = {
          vertices: wkt,
          elevation: 0,
          height: 50,
          style: {
            fillColor: '#ccc',
            borderColor: '#999'
          }
        };
        cesiumAtlas.publish('entity/show', args);
      });
      cesiumAtlas.publish('camera/zoomTo', {
        position: {
          latitude: -37.8,
          longitude: 144.96,
          elevation: 2000
        }
      });

      // Prototypes for individual modules.

      setTimeout(function() {
        require([
          './prototypes/CameraPrototype',
          './prototypes/EditPrototype',
          './prototypes/DrawPrototype',
          './prototypes/LineDrawPrototype',
          './prototypes/TranslatePrototype',
          './prototypes/RotationPrototype',
          './prototypes/ScalePrototype',
          './prototypes/MeshPrototype',
          './prototypes/MeshPrototype2',
          './prototypes/MeshPrototype3',
          './prototypes/MeshPrototype4',
          './prototypes/MeshPrototype5',
          './prototypes/MeshCollectionPrototype',
          './prototypes/GltfMeshPrototype',
          './prototypes/LinePrototype',
          './prototypes/GeocoderPrototype',
          './prototypes/InputPrototype',
          './prototypes/RenderPrototype',
          './prototypes/StylePrototype',
          './prototypes/EventPrototype',
          './prototypes/ProjectionPrototype',
          './prototypes/CollectionPrototype',
          './prototypes/SelectionPrototype',
          './prototypes/PolygonTransformPrototype',
          './prototypes/PopupPrototype',
          './prototypes/PopupPrototype2',
          './prototypes/MaterialPrototype',
          'atlas/lib/utility/Log'
        ], function(CameraPrototype, EditPrototype, DrawPrototype, LineDrawPrototype, TranslatePrototype,
                    RotationPrototype, ScalePrototype, MeshPrototype, MeshPrototype2, 
                    MeshPrototype3, MeshPrototype4, MeshPrototype5, MeshCollectionPrototype,
                    GltfMeshPrototype, LinePrototype, GeocoderPrototype, InputPrototype,
                    RenderPrototype, StylePrototype, EventPrototype, ProjectionPrototype,
                    CollectionPrototype, SelectionPrototype, PolygonTransformPrototype,
                    PopupPrototype, PopupPrototype2, MaterialPrototype, Log) {
         // new CameraPrototype(cesiumAtlas);
         // new EditPrototype(cesiumAtlas);
         // new DrawPrototype(cesiumAtlas);
         // new LineDrawPrototype(cesiumAtlas);
         // new TranslatePrototype(cesiumAtlas);
         // new RotationPrototype(cesiumAtlas);
         // new ScalePrototype(cesiumAtlas);
         // new MeshPrototype(cesiumAtlas);
         // new MeshPrototype2(cesiumAtlas);
         // new MeshPrototype3(cesiumAtlas);
         // new MeshPrototype4(cesiumAtlas);
         // new MeshPrototype5(cesiumAtlas);
         // new MeshCollectionPrototype(cesiumAtlas);
         // new GltfMeshPrototype(cesiumAtlas);
         // new LinePrototype(cesiumAtlas);
         // new GeocoderPrototype(cesiumAtlas);
         // new InputPrototype(cesiumAtlas);
         // new RenderPrototype(cesiumAtlas);
         // new StylePrototype(cesiumAtlas);
         // new EventPrototype(cesiumAtlas);
         // new ProjectionPrototype(cesiumAtlas);
         // new CollectionPrototype(cesiumAtlas);
         // new SelectionPrototype(cesiumAtlas);
         // new PolygonTransformPrototype(cesiumAtlas);
         // new PopupPrototype(cesiumAtlas);
         // new PopupPrototype2(cesiumAtlas);
         new MaterialPrototype(cesiumAtlas);
          Log.setLevel('debug');
        });
      }, 2000);

    });

  </script>
</head>
<body>
  <div id="cesium"></div>
</body>
</html>